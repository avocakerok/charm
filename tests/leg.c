/* Header files */
/* ------------------------------------------------------------------------- */
#include <config.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <float.h>
#ifdef _MSC_VER
#   define _USE_MATH_DEFINES
#endif
#include <math.h>
#include "../src/prec.h"
/* ------------------------------------------------------------------------- */






/* Function prototypes */
/* ------------------------------------------------------------------------- */
int cmp_arrays(REAL *, REAL *, size_t, REAL);
/* ------------------------------------------------------------------------- */






/* Function to test the "leg" module */
/* ------------------------------------------------------------------------- */
int leg(unsigned long nmax)
{
    /* --------------------------------------------------------------------- */
    if (nmax != 10)
    {
        fprintf(stderr, "\"nmax\" has to be \"10\".\n");
        exit(CHARM_FAILURE);
    }
    /* --------------------------------------------------------------------- */






    /* Initialize an error structure to be used throughout the function */
    /* --------------------------------------------------------------------- */
    CHARM(err) *err = CHARM(err_init)();
    if (err == NULL)
    {
        fprintf(stderr, "Failed to initialize an \"err\" structure.\n");
        exit(CHARM_FAILURE);
    }
    /* --------------------------------------------------------------------- */






    /* --------------------------------------------------------------------- */
    int errnum = 0;
    printf("    Initializing the \"pnmj\" structure "
           "(CHARM_LEG_PNMJ_ORDER_MNJ)...\n");
    CHARM(pnmj) *pnmj = CHARM(leg_pnmj_init)(nmax, CHARM_LEG_PNMJ_ORDER_MNJ);
    if (pnmj == NULL)
    {
        fprintf(stderr, "Failed to initialize the \"pnmj\" structure.\n");
        exit(CHARM_FAILURE);
    }
    CHARM(leg_pnmj_coeffs)(pnmj, nmax, err);
    CHARM(err_handler)(err, 1);


    REAL pnmj_ref_mnj[271] = {
                           ADDP( 1.0000000000000000000000000000000000e+00),
                           ADDP( 1.7320508075688772935274463415058723e+00),
                           ADDP( 5.5901699437494742410229341718281908e-01),
                           ADDP( 1.6770509831248422723068802515484572e+00),
                           ADDP( 9.9215674164922147143810590761472270e-01),
                           ADDP( 1.6535945694153691190635098460245377e+00),
                           ADDP( 4.2187500000000000000000000000000000e-01),
                           ADDP( 9.3750000000000000000000000000000000e-01),
                           ADDP( 1.6406250000000000000000000000000000e+00),
                           ADDP( 7.7733393523954683963631236015719197e-01),
                           ADDP( 9.0688959111280464624236442018339092e-01),
                           ADDP( 1.6324012640030483632362559563301033e+00),
                           ADDP( 3.5210461674453020440617395190141569e-01),
                           ADDP( 7.3941969516351342925296529899297266e-01),
                           ADDP( 8.8730363419621611510355835879156766e-01),
                           ADDP( 1.6267233293597295443565236577845397e+00),
                           ADDP( 6.6188680233036909658825336422062494e-01),
                           ADDP( 7.1483774651679862431531363335827486e-01),
                           ADDP( 8.7369057907608720749649444077122483e-01),
                           ADDP( 1.6225682182841619567792039614322736e+00),
                           ADDP( 3.0827663521616419516181805868946796e-01),
                           ADDP( 6.3416907815896634433288286358976284e-01),
                           ADDP( 6.9758598597486297876617114994873895e-01),
                           ADDP( 8.6367788739744940228192618565081941e-01),
                           ADDP( 1.6193960388702176292786115980952882e+00),
                           ADDP( 5.8663160220380768937271394497134095e-01),
                           ADDP( 6.1456644040398900791427175187473820e-01),
                           ADDP( 6.8480260502158775167590280923185118e-01),
                           ADDP( 8.5600325627698468959487851153981408e-01),
                           ADDP( 1.6168950396343044136792149662418709e+00),
                           ADDP( 2.7753056233642164590679869555521347e-01),
                           ADDP( 5.6534003438900705647681215761247177e-01),
                           ADDP( 5.9995268955568095789375984073160277e-01),
                           ADDP( 6.7494677575014107763047982082305308e-01),
                           ADDP( 8.4993297687054802368282644103643681e-01),
                           ADDP( 1.6148726560540412449973702379692298e+00),
                           ADDP( 1.7320508075688772935274463415058723e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 1.9364916731037084425896326998911997e+00),
                           ADDP( 4.0504629365049126443537296475549979e-01),
                           ADDP( 2.0252314682524563221768648237774991e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 5.9292706128157112474979253958113473e-01),
                           ADDP( 2.0752447144854989366242738885339714e+00),
                           ADDP( 2.0070675904164264093932653871312404e-01),
                           ADDP( 7.0247365664574924328764288549593392e-01),
                           ADDP( 2.1074209699372477298629286564878022e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 3.2270921175504504026987160766828551e-01),
                           ADDP( 7.7450210821210809664769185840388583e-01),
                           ADDP( 2.1298807975832972657811526106106846e+00),
                           ADDP( 1.2508484821728025370142869483057923e-01),
                           ADDP( 4.0527490822398802199262897125107672e-01),
                           ADDP( 8.2555999823404967442942938588182293e-01),
                           ADDP( 2.1464559954085291535165164032927390e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 2.1138969271965544811096095452992090e-01),
                           ADDP( 4.6505732398324198584411409996582626e-01),
                           ADDP( 8.6367788739744940228192618565081912e-01),
                           ADDP( 2.1591947184936235057048154641270504e+00),
                           ADDP( 8.7449876018488628802810469994216272e-02),
                           ADDP( 2.7484246748667854766597576283896573e-01),
                           ADDP( 5.1042172533240301709395498812950762e-01),
                           ADDP( 8.9323801933170527991442122922663838e-01),
                           ADDP( 2.1692923326627128226493086995504087e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 1.5246086937201324350508774986657151e-01),
                           ADDP( 3.2359041662631382294957399971680488e-01),
                           ADDP( 5.4605882805690457622740612452210851e-01),
                           ADDP( 9.1683951377455583169045966586428054e-01),
                           ADDP( 2.1774938452145701002648417064276669e+00),
                           ADDP( 9.6824583655185422129481634994559985e-01),
                           ADDP(-9.6824583655185422129481634994559985e-01),
                           ADDP( 1.2808688457449497979026298350651314e+00),
                           ADDP(-1.2808688457449497979026298350651314e+00),
                           ADDP( 6.2889411867181585211508009433067149e-01),
                           ADDP( 8.3852549156242113615344012577422862e-01),
                           ADDP(-1.4674196102342369882685202201049000e+00),
                           ADDP( 1.0620403417479017778857813324038728e+00),
                           ADDP( 5.3102017087395088894289066620193681e-01),
                           ADDP(-1.5930605126218526668286719986058095e+00),
                           ADDP( 5.1024806553176294232220966205214948e-01),
                           ADDP( 8.6742171140399700194775642548865378e-01),
                           ADDP( 3.0614883931905776539332579723128938e-01),
                           ADDP(-1.6838186162548177096632918847720932e+00),
                           ADDP( 9.1918215805745604636273782129720315e-01),
                           ADDP( 6.9857844012366659523568074418587432e-01),
                           ADDP( 1.3481338318176022013320154712358993e-01),
                           ADDP(-1.7525739813628828617316201126066672e+00),
                           ADDP( 4.4215326479964250975936407040268426e-01),
                           ADDP( 8.0850882706220344641712287159347992e-01),
                           ADDP( 5.5584981860526486941177197422051711e-01),
                           ADDP( 3.8518598887744717061119558851698546e-34),
                           ADDP(-1.8065119104671108255882589162166819e+00),
                           ADDP( 8.2035255334344810471145440524405211e-01),
                           ADDP( 7.0315933143724123260981806163775910e-01),
                           ADDP( 4.3528910993733981066322070482337500e-01),
                           ADDP(-1.0882227748433495266580517620584315e-01),
                           ADDP(-1.8499787172336941953186879954993430e+00),
                           ADDP( 3.9610495787767297254730076619091027e-01),
                           ADDP( 7.4819825376893783703379033613838590e-01),
                           ADDP( 6.0718129597575267447159936041962673e-01),
                           ADDP( 3.3278205644824906197001118792229541e-01),
                           ADDP(-1.9850157753053452819263825244487741e-01),
                           ADDP(-1.8857649865400780178300633982263395e+00),
                           ADDP( 1.5687375497513916524590725483472264e+00),
                           ADDP(-5.2291251658379721748635751611574214e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 1.5687375497513916524590725483472264e+00),
                           ADDP(-7.8436877487569582622953627417361321e-01),
                           ADDP( 6.5036423088335662250342479434896174e-01),
                           ADDP( 1.4091225002472726820907537210894174e+00),
                           ADDP(-9.7554634632503493375513719152344271e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 9.1844651795717329617997739169386871e-01),
                           ADDP( 1.2245953572762310615733031889251587e+00),
                           ADDP(-1.1225457441698784731088612565147288e+00),
                           ADDP( 3.8997596226486726843095181609414959e-01),
                           ADDP( 1.0139375018886548979204747218447888e+00),
                           ADDP( 1.0486020318677542106698926610531578e+00),
                           ADDP(-1.2392569467528004307916913266991866e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 6.1578344639442326818568802961432715e-01),
                           ADDP( 1.0263057439907054469761467160238785e+00),
                           ADDP( 8.8946497812527805404599382055402799e-01),
                           ADDP(-1.3341974671879170810689907308310421e+00),
                           ADDP( 2.6852340516047496491381432958499460e-01),
                           ADDP( 7.4163607139559752214291576742522352e-01),
                           ADDP( 9.9737264773890701253702465274426626e-01),
                           ADDP( 7.4802948580418025940276848955819989e-01),
                           ADDP(-1.4129445842967849344274515913877110e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 4.4883264658868945870672292569554471e-01),
                           ADDP( 8.0606679387356474216717586655526426e-01),
                           ADDP( 9.4804446779447671379889434305079376e-01),
                           ADDP( 6.2286979526593639167463589688361354e-01),
                           ADDP(-1.4793157637565989302272602550985814e+00),
                           ADDP( 8.3194871949838350598603054100085243e-01),
                           ADDP(-1.1092649593311780079813740546678032e+00),
                           ADDP( 2.7731623983279450199534351366695079e-01),
                           ADDP( 9.1975391579758985008715642761789562e-01),
                           ADDP(-1.3796308736963847751307346414268434e+00),
                           ADDP( 4.5987695789879492504357821380894781e-01),
                           ADDP( 5.5894875083024159130036421056048429e-01),
                           ADDP( 2.7947437541512079565018210528024210e-01),
                           ADDP(-1.4532667521586281373809469474572593e+00),
                           ADDP( 6.1484362591326575043040063161653275e-01),
                           ADDP( 8.6226929606024048445670915089177719e-01),
                           ADDP(-1.7245385921204809689134183017835538e-01),
                           ADDP(-1.4371154934337341407611819181529622e+00),
                           ADDP( 7.4730005658554175319581459743954034e-01),
                           ADDP( 4.6373425636918507348552834914516752e-01),
                           ADDP( 5.2998200727906865541203239902304874e-01),
                           ADDP(-4.7698380655116178987082915912074413e-01),
                           ADDP(-1.3779532189255785040712842374599261e+00),
                           ADDP( 8.6122076182848656504455264841245389e-01),
                           ADDP( 7.9051150046312659963698029864757682e-01),
                           ADDP( 2.2586042870375045703913722818502205e-01),
                           ADDP(-6.7758128611125137111741168455506566e-01),
                           ADDP(-1.2986974650465651279750390620638764e+00),
                           ADDP( 9.5990682199093944241633321978634381e-01),
                           ADDP( 4.0805049602670101131646876385573352e-01),
                           ADDP( 5.8940627203856812745712154779161498e-01),
                           ADDP(-2.5907968001695302305807540562268630e-02),
                           ADDP(-8.0638550405276628426825970000061610e-01),
                           ADDP(-1.2111975040792553827965025212860659e+00),
                           ADDP( 1.0460342080684478305969794502016025e+00),
                           ADDP( 1.4542586303895535073593642916542354e+00),
                           ADDP(-7.2712931519477675367968214582711771e-01),
                           ADDP( 1.4542586303895535073593642916542354e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 1.3108510149138922072668134021434230e+00),
                           ADDP(-1.0486808119311137658134507217147385e+00),
                           ADDP( 2.6217020298277844145336268042868462e-01),
                           ADDP( 7.1855774671686707038059095907648103e-01),
                           ADDP( 9.4849622566626453290238006598095483e-01),
                           ADDP(-1.2359193243530113610546164496115476e+00),
                           ADDP( 3.7365002829277087659790729871977017e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 9.5543865115900562412835505620315979e-01),
                           ADDP( 5.7326319069540337447701303372189549e-01),
                           ADDP(-1.3376141116226078737796970786844233e+00),
                           ADDP( 4.7771932557950281206417752810157975e-01),
                           ADDP( 4.7242098068069383977604203933846022e-01),
                           ADDP( 9.4484196136138767955208407867692083e-01),
                           ADDP( 2.4295936149292826045625019165978024e-01),
                           ADDP(-1.3835185862791748164869802580626337e+00),
                           ADDP( 5.7365404796941394829947961919670199e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 7.1687164878103480084903857929718441e-01),
                           ADDP( 8.1928188432118262954175837633963973e-01),
                           ADDP(-3.0723070662044348607815939112736406e-02),
                           ADDP(-1.3927792033460104702209892397773867e+00),
                           ADDP( 6.6157012158935497335496988889425876e-01),
                           ADDP( 7.5682018632802980356313887218008772e-01),
                           ADDP(-1.1352302794920447053447083082701315e+00),
                           ADDP( 4.5409211179681788213788332330805260e-01),
                           ADDP(-7.5682018632802980356313887218008767e-02),
                           ADDP( 7.3278799443051340197015987868660376e-01),
                           ADDP(-1.3190183899749241235462877816358867e+00),
                           ADDP( 7.3278799443051340197015987868660385e-01),
                           ADDP(-1.4655759888610268039403197573732076e-01),
                           ADDP( 5.1599584594983983720292048442980140e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP(-1.2383900302796156092870091626315235e+00),
                           ADDP( 9.4353526116542141659962602867163687e-01),
                           ADDP(-2.2114107683564564451553735046991486e-01),
                           ADDP( 7.3187143623012122939341064800243484e-01),
                           ADDP(-4.8791429082008081959560709866829002e-01),
                           ADDP(-1.0455306231858874705620152114320504e+00),
                           ADDP( 1.0978071543451818440901159720036522e+00),
                           ADDP(-2.9623367656933478332590430990574752e-01),
                           ADDP( 4.3280290921052197803862567834927546e-01),
                           ADDP( 3.0456501018518213269384769957911980e-01),
                           ADDP(-7.6026754422165765454404087413735163e-01),
                           ADDP(-8.1408166256264848250122449022839898e-01),
                           ADDP( 1.2068102283277517588696070502120004e+00),
                           ADDP(-3.6982894093914973255681506377464534e-01),
                           ADDP( 1.3709208061500961450011617765380205e+00),
                           ADDP(-8.2255248369005768700069706592281232e-01),
                           ADDP( 2.7418416123001922900023235530760412e-01),
                           ADDP(-3.9169165890002747000033193615372015e-02),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 1.1304902576227519417266769151269445e+00),
                           ADDP(-1.1304902576227519417266769151269447e+00),
                           ADDP( 4.8449582469546511788286153505440480e-01),
                           ADDP(-8.0749304115910852980476922509067463e-02),
                           ADDP( 7.3945579875940240704327317035039500e-01),
                           ADDP( 6.3381925607948777746566271744319583e-01),
                           ADDP(-1.2374566428218570893377224483414777e+00),
                           ADDP( 6.7154659275088585945766645062433826e-01),
                           ADDP(-1.2827294468275347877281269281588488e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 9.2529220505534439392083149404897229e-01),
                           ADDP( 1.5106811511107663574217657045697523e-01),
                           ADDP(-1.2179866780830553756712985993093615e+00),
                           ADDP( 8.3087463311092149658197113751336276e-01),
                           ADDP(-1.7939338669440350494383467741765786e-01),
                           ADDP( 7.0655641101421996357917307195434036e-01),
                           ADDP(-1.1304902576227519417266769151269445e+00),
                           ADDP( 5.6524512881137597086333845756347235e-01),
                           ADDP(-1.6149860823182170596095384501813493e-01),
                           ADDP( 2.0187326028977713245119230627266866e-02),
                           ADDP( 6.1596159870435466436272547407287569e-01),
                           ADDP(-1.2319231974087093287254509481457516e+00),
                           ADDP( 8.7994514100622094908960782010410831e-01),
                           ADDP(-3.0798079935217733218136273703643785e-01),
                           ADDP( 4.3997257050311047454480391005205414e-02),
                           ADDP( 4.8567723543434897670392141324063337e-01),
                           ADDP(-1.6189241181144965890130713774687768e-01),
                           ADDP(-1.0176094456719692845225020086946606e+00),
                           ADDP( 1.0754281641760584484158259864614025e+00),
                           ADDP(-4.5484058556550142262748195843170420e-01),
                           ADDP( 7.3237043438512940931543705171206606e-02),
                           ADDP( 1.3066518701830683262924377933804530e+00),
                           ADDP(-8.7110124678871221752829186225363540e-01),
                           ADDP( 3.7332910576659095036926794096584375e-01),
                           ADDP(-9.3332276441647737592316985241460937e-02),
                           ADDP( 1.0370252937960859732479665026828993e-02),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 9.9797185034492039576884246391577347e-01),
                           ADDP(-1.1405392575370518808786771016180269e+00),
                           ADDP( 6.4155333236459168299425586966014003e-01),
                           ADDP(-1.9008987625617531347977951693633778e-01),
                           ADDP( 2.3761234532021914184972439617042222e-02),
                           ADDP( 6.6945986910074668491049919728845591e-01),
                           ADDP(-1.1157664485012444748508319954807598e+00),
                           ADDP( 6.3758082771499684277190399741757713e-01),
                           ADDP(-2.3909281039312381603946399903159139e-01),
                           ADDP( 5.3131735642916403564325333118131412e-02),
                           ADDP(-5.3131735642916403564325333118131412e-03)};


    printf("    Fourier coefficients of Legendre functions "
           "(CHARM_LEG_PNMJ_ORDER_MNJ)...\n");
    errnum += cmp_arrays(pnmj->pnmj[0][0], pnmj_ref_mnj,
                         CHARM(leg_pnmj_length)(nmax), CHARM(glob_threshold));


    printf("    Freeing the \"pnmj\" structure...\n");
    CHARM(leg_pnmj_free)(pnmj);
    /* --------------------------------------------------------------------- */






    /* Now do the same, but with a different ordering scheme of the "pnmj"
     * coefficients */
    /* --------------------------------------------------------------------- */
    printf("    Initializing the \"pnmj\" structure "
           "(CHARM_LEG_PNMJ_ORDER_MJN) ordering...\n");
    pnmj = CHARM(leg_pnmj_init)(nmax, CHARM_LEG_PNMJ_ORDER_MJN);
    CHARM(leg_pnmj_coeffs)(pnmj, nmax, err);
    CHARM(err_handler)(err, 1);


    REAL pnmj_ref_mjn[271] = {
                           ADDP( 1.0000000000000000000000000000000000e+00),
                           ADDP( 1.7320508075688772935274463415058723e+00),
                           ADDP( 5.5901699437494742410229341718281908e-01),
                           ADDP( 9.9215674164922147143810590761472270e-01),
                           ADDP( 4.2187500000000000000000000000000000e-01),
                           ADDP( 7.7733393523954683963631236015719197e-01),
                           ADDP( 3.5210461674453020440617395190141569e-01),
                           ADDP( 6.6188680233036909658825336422062494e-01),
                           ADDP( 3.0827663521616419516181805868946796e-01),
                           ADDP( 5.8663160220380768937271394497134095e-01),
                           ADDP( 2.7753056233642164590679869555521347e-01),
                           ADDP( 1.6770509831248422723068802515484572e+00),
                           ADDP( 1.6535945694153691190635098460245377e+00),
                           ADDP( 9.3750000000000000000000000000000000e-01),
                           ADDP( 9.0688959111280464624236442018339092e-01),
                           ADDP( 7.3941969516351342925296529899297266e-01),
                           ADDP( 7.1483774651679862431531363335827486e-01),
                           ADDP( 6.3416907815896634433288286358976284e-01),
                           ADDP( 6.1456644040398900791427175187473820e-01),
                           ADDP( 5.6534003438900705647681215761247177e-01),
                           ADDP( 1.6406250000000000000000000000000000e+00),
                           ADDP( 1.6324012640030483632362559563301033e+00),
                           ADDP( 8.8730363419621611510355835879156766e-01),
                           ADDP( 8.7369057907608720749649444077122483e-01),
                           ADDP( 6.9758598597486297876617114994873895e-01),
                           ADDP( 6.8480260502158775167590280923185118e-01),
                           ADDP( 5.9995268955568095789375984073160277e-01),
                           ADDP( 1.6267233293597295443565236577845397e+00),
                           ADDP( 1.6225682182841619567792039614322736e+00),
                           ADDP( 8.6367788739744940228192618565081941e-01),
                           ADDP( 8.5600325627698468959487851153981408e-01),
                           ADDP( 6.7494677575014107763047982082305308e-01),
                           ADDP( 1.6193960388702176292786115980952882e+00),
                           ADDP( 1.6168950396343044136792149662418709e+00),
                           ADDP( 8.4993297687054802368282644103643681e-01),
                           ADDP( 1.6148726560540412449973702379692298e+00),
                           ADDP( 1.7320508075688772935274463415058723e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 4.0504629365049126443537296475549979e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 2.0070675904164264093932653871312404e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 1.2508484821728025370142869483057923e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 8.7449876018488628802810469994216272e-02),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 1.9364916731037084425896326998911997e+00),
                           ADDP( 2.0252314682524563221768648237774991e+00),
                           ADDP( 5.9292706128157112474979253958113473e-01),
                           ADDP( 7.0247365664574924328764288549593392e-01),
                           ADDP( 3.2270921175504504026987160766828551e-01),
                           ADDP( 4.0527490822398802199262897125107672e-01),
                           ADDP( 2.1138969271965544811096095452992090e-01),
                           ADDP( 2.7484246748667854766597576283896573e-01),
                           ADDP( 1.5246086937201324350508774986657151e-01),
                           ADDP( 2.0752447144854989366242738885339714e+00),
                           ADDP( 2.1074209699372477298629286564878022e+00),
                           ADDP( 7.7450210821210809664769185840388583e-01),
                           ADDP( 8.2555999823404967442942938588182293e-01),
                           ADDP( 4.6505732398324198584411409996582626e-01),
                           ADDP( 5.1042172533240301709395498812950762e-01),
                           ADDP( 3.2359041662631382294957399971680488e-01),
                           ADDP( 2.1298807975832972657811526106106846e+00),
                           ADDP( 2.1464559954085291535165164032927390e+00),
                           ADDP( 8.6367788739744940228192618565081912e-01),
                           ADDP( 8.9323801933170527991442122922663838e-01),
                           ADDP( 5.4605882805690457622740612452210851e-01),
                           ADDP( 2.1591947184936235057048154641270504e+00),
                           ADDP( 2.1692923326627128226493086995504087e+00),
                           ADDP( 9.1683951377455583169045966586428054e-01),
                           ADDP( 2.1774938452145701002648417064276669e+00),
                           ADDP( 9.6824583655185422129481634994559985e-01),
                           ADDP( 1.2808688457449497979026298350651314e+00),
                           ADDP( 6.2889411867181585211508009433067149e-01),
                           ADDP( 1.0620403417479017778857813324038728e+00),
                           ADDP( 5.1024806553176294232220966205214948e-01),
                           ADDP( 9.1918215805745604636273782129720315e-01),
                           ADDP( 4.4215326479964250975936407040268426e-01),
                           ADDP( 8.2035255334344810471145440524405211e-01),
                           ADDP( 3.9610495787767297254730076619091027e-01),
                           ADDP(-9.6824583655185422129481634994559985e-01),
                           ADDP(-1.2808688457449497979026298350651314e+00),
                           ADDP( 8.3852549156242113615344012577422862e-01),
                           ADDP( 5.3102017087395088894289066620193681e-01),
                           ADDP( 8.6742171140399700194775642548865378e-01),
                           ADDP( 6.9857844012366659523568074418587432e-01),
                           ADDP( 8.0850882706220344641712287159347992e-01),
                           ADDP( 7.0315933143724123260981806163775910e-01),
                           ADDP( 7.4819825376893783703379033613838590e-01),
                           ADDP(-1.4674196102342369882685202201049000e+00),
                           ADDP(-1.5930605126218526668286719986058095e+00),
                           ADDP( 3.0614883931905776539332579723128938e-01),
                           ADDP( 1.3481338318176022013320154712358993e-01),
                           ADDP( 5.5584981860526486941177197422051711e-01),
                           ADDP( 4.3528910993733981066322070482337500e-01),
                           ADDP( 6.0718129597575267447159936041962673e-01),
                           ADDP(-1.6838186162548177096632918847720932e+00),
                           ADDP(-1.7525739813628828617316201126066672e+00),
                           ADDP( 3.8518598887744717061119558851698546e-34),
                           ADDP(-1.0882227748433495266580517620584315e-01),
                           ADDP( 3.3278205644824906197001118792229541e-01),
                           ADDP(-1.8065119104671108255882589162166819e+00),
                           ADDP(-1.8499787172336941953186879954993430e+00),
                           ADDP(-1.9850157753053452819263825244487741e-01),
                           ADDP(-1.8857649865400780178300633982263395e+00),
                           ADDP( 1.5687375497513916524590725483472264e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 6.5036423088335662250342479434896174e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 3.8997596226486726843095181609414959e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 2.6852340516047496491381432958499460e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP(-5.2291251658379721748635751611574214e-01),
                           ADDP( 1.5687375497513916524590725483472264e+00),
                           ADDP( 1.4091225002472726820907537210894174e+00),
                           ADDP( 9.1844651795717329617997739169386871e-01),
                           ADDP( 1.0139375018886548979204747218447888e+00),
                           ADDP( 6.1578344639442326818568802961432715e-01),
                           ADDP( 7.4163607139559752214291576742522352e-01),
                           ADDP( 4.4883264658868945870672292569554471e-01),
                           ADDP(-7.8436877487569582622953627417361321e-01),
                           ADDP(-9.7554634632503493375513719152344271e-01),
                           ADDP( 1.2245953572762310615733031889251587e+00),
                           ADDP( 1.0486020318677542106698926610531578e+00),
                           ADDP( 1.0263057439907054469761467160238785e+00),
                           ADDP( 9.9737264773890701253702465274426626e-01),
                           ADDP( 8.0606679387356474216717586655526426e-01),
                           ADDP(-1.1225457441698784731088612565147288e+00),
                           ADDP(-1.2392569467528004307916913266991866e+00),
                           ADDP( 8.8946497812527805404599382055402799e-01),
                           ADDP( 7.4802948580418025940276848955819989e-01),
                           ADDP( 9.4804446779447671379889434305079376e-01),
                           ADDP(-1.3341974671879170810689907308310421e+00),
                           ADDP(-1.4129445842967849344274515913877110e+00),
                           ADDP( 6.2286979526593639167463589688361354e-01),
                           ADDP(-1.4793157637565989302272602550985814e+00),
                           ADDP( 8.3194871949838350598603054100085243e-01),
                           ADDP( 9.1975391579758985008715642761789562e-01),
                           ADDP( 5.5894875083024159130036421056048429e-01),
                           ADDP( 8.6226929606024048445670915089177719e-01),
                           ADDP( 4.6373425636918507348552834914516752e-01),
                           ADDP( 7.9051150046312659963698029864757682e-01),
                           ADDP( 4.0805049602670101131646876385573352e-01),
                           ADDP(-1.1092649593311780079813740546678032e+00),
                           ADDP(-1.3796308736963847751307346414268434e+00),
                           ADDP( 2.7947437541512079565018210528024210e-01),
                           ADDP(-1.7245385921204809689134183017835538e-01),
                           ADDP( 5.2998200727906865541203239902304874e-01),
                           ADDP( 2.2586042870375045703913722818502205e-01),
                           ADDP( 5.8940627203856812745712154779161498e-01),
                           ADDP( 2.7731623983279450199534351366695079e-01),
                           ADDP( 4.5987695789879492504357821380894781e-01),
                           ADDP(-1.4532667521586281373809469474572593e+00),
                           ADDP(-1.4371154934337341407611819181529622e+00),
                           ADDP(-4.7698380655116178987082915912074413e-01),
                           ADDP(-6.7758128611125137111741168455506566e-01),
                           ADDP(-2.5907968001695302305807540562268630e-02),
                           ADDP( 6.1484362591326575043040063161653275e-01),
                           ADDP( 7.4730005658554175319581459743954034e-01),
                           ADDP(-1.3779532189255785040712842374599261e+00),
                           ADDP(-1.2986974650465651279750390620638764e+00),
                           ADDP(-8.0638550405276628426825970000061610e-01),
                           ADDP( 8.6122076182848656504455264841245389e-01),
                           ADDP( 9.5990682199093944241633321978634381e-01),
                           ADDP(-1.2111975040792553827965025212860659e+00),
                           ADDP( 1.0460342080684478305969794502016025e+00),
                           ADDP( 1.4542586303895535073593642916542354e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 7.1855774671686707038059095907648103e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 4.7242098068069383977604203933846022e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP(-7.2712931519477675367968214582711771e-01),
                           ADDP( 1.3108510149138922072668134021434230e+00),
                           ADDP( 9.4849622566626453290238006598095483e-01),
                           ADDP( 9.5543865115900562412835505620315979e-01),
                           ADDP( 9.4484196136138767955208407867692083e-01),
                           ADDP( 7.1687164878103480084903857929718441e-01),
                           ADDP( 1.4542586303895535073593642916542354e-01),
                           ADDP(-1.0486808119311137658134507217147385e+00),
                           ADDP(-1.2359193243530113610546164496115476e+00),
                           ADDP( 5.7326319069540337447701303372189549e-01),
                           ADDP( 2.4295936149292826045625019165978024e-01),
                           ADDP( 8.1928188432118262954175837633963973e-01),
                           ADDP( 2.6217020298277844145336268042868462e-01),
                           ADDP( 3.7365002829277087659790729871977017e-01),
                           ADDP(-1.3376141116226078737796970786844233e+00),
                           ADDP(-1.3835185862791748164869802580626337e+00),
                           ADDP(-3.0723070662044348607815939112736406e-02),
                           ADDP( 4.7771932557950281206417752810157975e-01),
                           ADDP( 5.7365404796941394829947961919670199e-01),
                           ADDP(-1.3927792033460104702209892397773867e+00),
                           ADDP( 6.6157012158935497335496988889425876e-01),
                           ADDP( 7.5682018632802980356313887218008772e-01),
                           ADDP( 7.3278799443051340197015987868660376e-01),
                           ADDP( 5.1599584594983983720292048442980140e-01),
                           ADDP( 7.3187143623012122939341064800243484e-01),
                           ADDP( 4.3280290921052197803862567834927546e-01),
                           ADDP(-1.1352302794920447053447083082701315e+00),
                           ADDP(-1.3190183899749241235462877816358867e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP(-4.8791429082008081959560709866829002e-01),
                           ADDP( 3.0456501018518213269384769957911980e-01),
                           ADDP( 4.5409211179681788213788332330805260e-01),
                           ADDP( 7.3278799443051340197015987868660385e-01),
                           ADDP(-1.2383900302796156092870091626315235e+00),
                           ADDP(-1.0455306231858874705620152114320504e+00),
                           ADDP(-7.6026754422165765454404087413735163e-01),
                           ADDP(-7.5682018632802980356313887218008767e-02),
                           ADDP(-1.4655759888610268039403197573732076e-01),
                           ADDP( 9.4353526116542141659962602867163687e-01),
                           ADDP( 1.0978071543451818440901159720036522e+00),
                           ADDP(-8.1408166256264848250122449022839898e-01),
                           ADDP(-2.2114107683564564451553735046991486e-01),
                           ADDP(-2.9623367656933478332590430990574752e-01),
                           ADDP( 1.2068102283277517588696070502120004e+00),
                           ADDP(-3.6982894093914973255681506377464534e-01),
                           ADDP( 1.3709208061500961450011617765380205e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP( 7.3945579875940240704327317035039500e-01),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP(-8.2255248369005768700069706592281232e-01),
                           ADDP( 1.1304902576227519417266769151269445e+00),
                           ADDP( 6.3381925607948777746566271744319583e-01),
                           ADDP( 9.2529220505534439392083149404897229e-01),
                           ADDP( 2.7418416123001922900023235530760412e-01),
                           ADDP(-1.1304902576227519417266769151269447e+00),
                           ADDP(-1.2374566428218570893377224483414777e+00),
                           ADDP( 1.5106811511107663574217657045697523e-01),
                           ADDP(-3.9169165890002747000033193615372015e-02),
                           ADDP( 4.8449582469546511788286153505440480e-01),
                           ADDP( 6.7154659275088585945766645062433826e-01),
                           ADDP(-1.2179866780830553756712985993093615e+00),
                           ADDP(-8.0749304115910852980476922509067463e-02),
                           ADDP(-1.2827294468275347877281269281588488e-01),
                           ADDP( 8.3087463311092149658197113751336276e-01),
                           ADDP(-1.7939338669440350494383467741765786e-01),
                           ADDP( 7.0655641101421996357917307195434036e-01),
                           ADDP( 6.1596159870435466436272547407287569e-01),
                           ADDP( 4.8567723543434897670392141324063337e-01),
                           ADDP(-1.1304902576227519417266769151269445e+00),
                           ADDP(-1.2319231974087093287254509481457516e+00),
                           ADDP(-1.6189241181144965890130713774687768e-01),
                           ADDP( 5.6524512881137597086333845756347235e-01),
                           ADDP( 8.7994514100622094908960782010410831e-01),
                           ADDP(-1.0176094456719692845225020086946606e+00),
                           ADDP(-1.6149860823182170596095384501813493e-01),
                           ADDP(-3.0798079935217733218136273703643785e-01),
                           ADDP( 1.0754281641760584484158259864614025e+00),
                           ADDP( 2.0187326028977713245119230627266866e-02),
                           ADDP( 4.3997257050311047454480391005205414e-02),
                           ADDP(-4.5484058556550142262748195843170420e-01),
                           ADDP( 7.3237043438512940931543705171206606e-02),
                           ADDP( 1.3066518701830683262924377933804530e+00),
                           ADDP( 0.0000000000000000000000000000000000e+00),
                           ADDP(-8.7110124678871221752829186225363540e-01),
                           ADDP( 9.9797185034492039576884246391577347e-01),
                           ADDP( 3.7332910576659095036926794096584375e-01),
                           ADDP(-1.1405392575370518808786771016180269e+00),
                           ADDP(-9.3332276441647737592316985241460937e-02),
                           ADDP( 6.4155333236459168299425586966014003e-01),
                           ADDP( 1.0370252937960859732479665026828993e-02),
                           ADDP(-1.9008987625617531347977951693633778e-01),
                           ADDP( 2.3761234532021914184972439617042222e-02),
                           ADDP( 6.6945986910074668491049919728845591e-01),
                           ADDP(-1.1157664485012444748508319954807598e+00),
                           ADDP( 6.3758082771499684277190399741757713e-01),
                           ADDP(-2.3909281039312381603946399903159139e-01),
                           ADDP( 5.3131735642916403564325333118131412e-02),
                           ADDP(-5.3131735642916403564325333118131412e-03)};

    printf("    Fourier coefficients of Legendre functions "
           "(CHARM_LEG_PNMJ_ORDER_MJN)...\n");
    errnum += cmp_arrays(pnmj->pnmj[0][0], pnmj_ref_mjn,
                         CHARM(leg_pnmj_length)(nmax), CHARM(glob_threshold));
    /* --------------------------------------------------------------------- */






    /* --------------------------------------------------------------------- */
    printf("    Freeing the \"pnmj\" structure...\n");
    CHARM(leg_pnmj_free)(pnmj);
    CHARM(err_free)(err);


    return errnum;
    /* --------------------------------------------------------------------- */
}
/* ------------------------------------------------------------------------- */


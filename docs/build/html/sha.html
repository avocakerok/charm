

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>charm_sha &mdash; CHarm 0.1.2-dev documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom_BB.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="charm_leg" href="leg.html" />
    <link rel="prev" title="charm_shs" href="shs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CHarm
          

          
            
            <img src="_static/charm-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1.2-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Some definitions to make things clear</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="shc.html">charm_shc</a></li>
<li class="toctree-l2"><a class="reference internal" href="crd.html">charm_crd</a></li>
<li class="toctree-l2"><a class="reference internal" href="shs.html">charm_shs</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">charm_sha</a></li>
<li class="toctree-l2"><a class="reference internal" href="leg.html">charm_leg</a></li>
<li class="toctree-l2"><a class="reference internal" href="integ.html">charm_integ</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc.html">charm_misc</a></li>
<li class="toctree-l2"><a class="reference internal" href="xnum.html">charm_xnum</a></li>
<li class="toctree-l2"><a class="reference internal" href="err.html">charm_err</a></li>
<li class="toctree-l2"><a class="reference internal" href="glob.html">charm_glob</a></li>
<li class="toctree-l2"><a class="reference internal" href="charm.html">charm</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Tested platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CHarm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">Modules</a> &raquo;</li>
        
      <li>charm_sha</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/sha.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="charm-sha">
<span id="id1"></span><h1>charm_sha<a class="headerlink" href="#charm-sha" title="Permalink to this headline">¶</a></h1>
<p>Module to perform surface spherical harmonic analysis using:</p>
<p><ul class="simple">
<li><p>point data values,</p></li>
<li><p>mean data values.</p></li>
</ul>
</p>
<p><p><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation is written for double precision version of 
CHarm.</p>
</div>
</p>
 </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum">
<dt id="_CPPv4Ut1_3">
<span id="_CPPv3Ut1_3"></span><span class="target" id="charm__sha_8h_1abc6126af1d45847bc59afa0aa3216b04"></span><em class="property">enum </em><strong>[anonymous]</strong><a class="headerlink" href="#_CPPv4Ut1_3" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Harmonic analysis methods using evaluation cells. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt id="_CPPv4NUt1_317CHARM_SHA_CELL_AQE">
<span id="_CPPv3NUt1_317CHARM_SHA_CELL_AQE"></span><span class="target" id="charm__sha_8h_1abc6126af1d45847bc59afa0aa3216b04ac5edf8164d412c4f07f63ad008ad12f8"></span><em class="property">enumerator </em><code class="sig-name descname">CHARM_SHA_CELL_AQ</code><a class="headerlink" href="#_CPPv4NUt1_317CHARM_SHA_CELL_AQE" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Spherical harmonic analysis of cell data using the <em>approximate</em> quadrature method. </p>
</dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt id="_CPPv415charm_sha_pointPK11charm_pointPKdmP9charm_shcP9charm_err">
<span id="_CPPv315charm_sha_pointPK11charm_pointPKdmP9charm_shcP9charm_err"></span><span id="_CPPv215charm_sha_pointPK11charm_pointPKdmP9charm_shcP9charm_err"></span><span id="charm_sha_point__charm_pointCP.doubleCP.unsigned-l.charm_shcP.charm_errP"></span><span class="target" id="charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"></span>void <code class="sig-name descname">charm_sha_point</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="crd.html#_CPPv411charm_point" title="charm_point">charm_point</a> *<em>pnt</em>, <em class="property">const</em> double *<em>f</em>, unsigned long <em>nmax</em>, <a class="reference internal" href="shc.html#_CPPv49charm_shc" title="charm_shc">charm_shc</a> *<em>shcs</em>, <a class="reference internal" href="err.html#_CPPv49charm_err" title="charm_err">charm_err</a> *<em>err</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415charm_sha_pointPK11charm_pointPKdmP9charm_shcP9charm_err" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs the exact surface spherical harmonic analysis based on point data values:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\left.\begin{aligned}
\bar{C}_{nm} \\
\bar{S}_{nm}
\end{aligned}\right\}
= \dfrac{1}{4 \pi} \, \dfrac{R}{\mu} \, \left( \dfrac{r}{R} \right)^n 
\displaystyle\iint_{\sigma} f(r, \varphi, \lambda) \, 
\bar{Y}_{nm}(\varphi,\lambda) \, \mathrm{d}\sigma {.}\end{split}\]</div>
</p>
<p>The coefficients are automatically normalized to the constants <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(R\)</span>, which are taken from <code class="docutils literal notranslate"><span class="pre">shcs-&gt;mu</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;r</span></code>, respectively. If <span class="math notranslate nohighlight">\(r \neq R\)</span> (<code class="docutils literal notranslate"><span class="pre">pnt-&gt;r[i]</span> <span class="pre">!=</span> <span class="pre">shcs-&gt;r</span></code>), the coefficients are also rescaled <strong>from</strong> the data sphere with the radius <span class="math notranslate nohighlight">\(r\)</span> <strong>to</strong> the reference sphere with the radius <span class="math notranslate nohighlight">\(R\)</span> using <code class="docutils literal notranslate"><a class="reference internal" href="shc.html#charm__shc_8h_1a1d014b8a7da1bd76d4ea49df16ec9cb5"><span class="std std-ref"><span class="pre">charm_shc_rescale()</span></span></a></code>. If <span class="math notranslate nohighlight">\(r = R = \mu = 1\)</span> (<code class="docutils literal notranslate"><span class="pre">pnt-&gt;r[i]</span> <span class="pre">==</span> <span class="pre">shcs-&gt;r</span> <span class="pre">==</span> <span class="pre">shcs-&gt;mu</span> <span class="pre">==</span> <span class="pre">1.0</span></code>), one gets the well-known relation for spherical harmonic analysis on the unit sphere (no normalization, no rescaling).</p>
<p>The integrals are evaluated by exact quadratures, either the Gauss-Legendre or the Driscoll-Healy one. The type of the quadrature to be applied is determined by <code class="docutils literal notranslate"><span class="pre">pnt-&gt;type</span></code>.</p>
<p>The loop over latitudes is parallelized using OpenMP.</p>
<p>The function exploits the symmetry property of Legendre functions with respect to the equator, thereby improving its performance. For further details on the grid requirements, see <code class="docutils literal notranslate"><a class="reference internal" href="shs.html#charm__shs_8h_1a47e78422d29ab4668f6140fe8a5b16af"><span class="std std-ref"><span class="pre">charm_shs_point()</span></span></a></code>.</p>
<p><strong>References</strong>:</p>
<p><ul class="simple">
<li><p>Driscoll, J. R., Healy, D. M. (1994) Computing Fourier transforms and convolutions on the 2-sphere. Advances in Applied Mathematics 15:202-250</p></li>
<li><p>Sneeuw, N. (1994) Global spherical harmonic analysis by least-squares and numerical quadrature methods in historical perspective. Geophysical Journal International 118:707-716</p></li>
<li><p>Heiskannen, W. A., Moritz, H. (1967) Physical Geodesy. W. H. Freeman and Company, San Francisco, 364 pp</p></li>
<li><p>Fukushima, T. (2012) Numerical computation of spherical harmonics of arbitrary degree and order by extending exponent of floating point numbers. Journal of Geodesy 86:271-285</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function modifies <code class="docutils literal notranslate"><span class="pre">shcs-&gt;c</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;s</span></code>, but it does not touch the remaining members of <code class="docutils literal notranslate"><span class="pre">shcs</span></code>. If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;</span> <span class="pre">nmax</span></code>, the coefficients beyond <code class="docutils literal notranslate"><span class="pre">nmax</span></code> are set to zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pnt</strong> – <strong>[in]</strong> Structure defining grid points and integration weights (see <code class="docutils literal notranslate"><a class="reference internal" href="crd.html#structcharm__point"><span class="std std-ref"><span class="pre">charm_point</span></span></a></code>). The <code class="docutils literal notranslate"><span class="pre">pnt</span></code> structure must be prepared by calling the <code class="docutils literal notranslate"><a class="reference internal" href="crd.html#charm__crd_8h_1a2f25d2e7fcfbd5950b3b8c41de1330c9"><span class="std std-ref"><span class="pre">charm_crd_point_gl()</span></span></a></code>, <code class="docutils literal notranslate"><a class="reference internal" href="crd.html#charm__crd_8h_1a3c695af1812dbd2be8e2a7a42dece1d0"><span class="std std-ref"><span class="pre">charm_crd_point_dh1()</span></span></a></code> or <code class="docutils literal notranslate"><a class="reference internal" href="crd.html#charm__crd_8h_1ad78de03b5329e9e4d7bf241eb61fb063"><span class="std std-ref"><span class="pre">charm_crd_point_dh2()</span></span></a></code> with some <code class="docutils literal notranslate"><span class="pre">nmax_signal</span></code>. Importantly, it is assumed that <strong>no</strong> harmonics (frequencies) are present in the input signal beyond <code class="docutils literal notranslate"><span class="pre">nmax_signal</span></code>. Otherwise, the output spherical harmonic coefficients will suffer from the alliasing effect.</p></li>
<li><p><strong>f</strong> – <strong>[in]</strong> Input signal with point data given at the nodes of the <code class="docutils literal notranslate"><span class="pre">pnt</span></code> structure and containing harmonics up to degree <code class="docutils literal notranslate"><span class="pre">nmax_signal</span></code> at most. The pointer <code class="docutils literal notranslate"><span class="pre">f</span></code> must have an access to <code class="docutils literal notranslate"><span class="pre">pnt-&gt;nlat</span> <span class="pre">*</span> <span class="pre">pnt-&gt;nlon</span></code> array elements. The value of <code class="docutils literal notranslate"><span class="pre">f</span></code> at <code class="docutils literal notranslate"><span class="pre">pnt-&gt;lat[i]</span></code> and <code class="docutils literal notranslate"><span class="pre">pnt-&gt;lon[j]</span></code> must be stored as <code class="docutils literal notranslate"><span class="pre">f[i</span> <span class="pre">*</span> <span class="pre">pnt-&gt;nlon</span> <span class="pre">+</span> <span class="pre">j]</span></code> with <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">pnt-&gt;nlat</span> <span class="pre">-</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">pnt-&gt;nlon</span> <span class="pre">-</span> <span class="pre">1</span></code>.</p></li>
<li><p><strong>nmax</strong> – <strong>[in]</strong> Maximum harmonic degree of the output spherical harmonic coefficients. If <code class="docutils literal notranslate"><span class="pre">f</span></code> is properly given at the nodes of the Gauss-Legendre or the Driscoll-Healy grid for <code class="docutils literal notranslate"><span class="pre">nmax_signal</span></code> and no harmonics are present beyond <code class="docutils literal notranslate"><span class="pre">nmax_signal</span></code> in <code class="docutils literal notranslate"><span class="pre">f</span></code>, than the output coefficients are computed exactly for all <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">&lt;=</span> <span class="pre">nmax_signal</span></code>.</p></li>
<li><p><strong>shcs</strong> – <strong>[out]</strong> Output spherical harmonic coefficients (see <code class="docutils literal notranslate"><a class="reference internal" href="shc.html#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code>).</p></li>
<li><p><strong>err</strong> – <strong>[out]</strong> Error reported by the function (if any). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt id="_CPPv414charm_sha_cellPK10charm_cellPKdmiP9charm_shcP9charm_err">
<span id="_CPPv314charm_sha_cellPK10charm_cellPKdmiP9charm_shcP9charm_err"></span><span id="_CPPv214charm_sha_cellPK10charm_cellPKdmiP9charm_shcP9charm_err"></span><span id="charm_sha_cell__charm_cellCP.doubleCP.unsigned-l.i.charm_shcP.charm_errP"></span><span class="target" id="charm__sha_8h_1a0cfef83c12175c434125d39f2a100080"></span>void <code class="sig-name descname">charm_sha_cell</code><span class="sig-paren">(</span><em class="property">const</em> <a class="reference internal" href="crd.html#_CPPv410charm_cell" title="charm_cell">charm_cell</a> *<em>cell</em>, <em class="property">const</em> double *<em>f</em>, unsigned long <em>nmax</em>, int <em>method</em>, <a class="reference internal" href="shc.html#_CPPv49charm_shc" title="charm_shc">charm_shc</a> *<em>shcs</em>, <a class="reference internal" href="err.html#_CPPv49charm_err" title="charm_err">charm_err</a> *<em>err</em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414charm_sha_cellPK10charm_cellPKdmiP9charm_shcP9charm_err" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Performs an approximate surface spherical harmonic analysis based on mean data values (area means, block-means) given over grid cells:</p>
<p><div class="math notranslate nohighlight">
\[\begin{split}\left.\begin{aligned}
\bar{C}_{nm} \\
\bar{S}_{nm} 
\end{aligned}
\right\}
=&amp; \dfrac{1}{4 \pi} \, \dfrac{R}{\mu} \, \left( \dfrac{r}{R} \right)^n \, 
\sum_{i,j} \tilde{f}(\varphi_i^{\min}, \varphi_i^{\max}, 
\lambda_j^{\min}, \lambda_j^{\max}) \\
&amp;\times \int\limits_{\varphi_i^\mathrm{\min}}^{\varphi_i^\mathrm{\max}} 
\bar{P}_{nm}(\sin\varphi) \, \cos\varphi \, \mathrm{d}\varphi \,
\int\limits_{\lambda_j^\mathrm{\min}}^{\lambda_j^\mathrm{\max}} 
\begin{Bmatrix} \cos m\lambda \\ \sin m\lambda \end{Bmatrix} 
\mathrm{d}\lambda{.}\end{split}\]</div>
</p>
<p>See also the comments from <code class="docutils literal notranslate"><a class="reference internal" href="#charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"><span class="std std-ref"><span class="pre">charm_sha_point()</span></span></a></code> on the normalization and rescaling of the coefficients with <span class="math notranslate nohighlight">\(R\)</span>, <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p>Applied is the approximate numerical quadrature due to Colombo (1981).</p>
<p>The loop over latitudes is parallelized using OpenMP.</p>
<p><strong>A note on grid cells</strong></p>
<p>Since the quadrature is approximate, the grid restrictions are more relaxed when compared with <code class="docutils literal notranslate"><a class="reference internal" href="#charm__sha_8h_1ae98177417defe2a6344b7fb62a1c74a7"><span class="std std-ref"><span class="pre">charm_sha_point()</span></span></a></code>. Yet, some conditions has to be fulfilled:</p>
<p><ul class="simple">
<li><p>at least <code class="docutils literal notranslate"><span class="pre">nmax</span> <span class="pre">+</span> <span class="pre">1</span></code> data values in <code class="docutils literal notranslate"><span class="pre">f</span></code> are required in the latitudinal direction,</p></li>
<li><p>at least <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">nmax</span> <span class="pre">+</span> <span class="pre">1</span></code> data values in <code class="docutils literal notranslate"><span class="pre">f</span></code> are required in the longitudinal direction,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cell-&gt;latmax[0]</span></code> has to be equal to <code class="docutils literal notranslate"><span class="pre">PI</span> <span class="pre">/</span> <span class="pre">2.0</span></code> (within the <code class="docutils literal notranslate"><span class="pre">charm_glob_threshold</span></code> limit, see the <code class="docutils literal notranslate"><span class="pre">charm_glob</span></code> module),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cell-&gt;latmin[cell-&gt;nlat</span> <span class="pre">-</span> <span class="pre">1]</span></code> has to be equal to <code class="docutils literal notranslate"><span class="pre">-PI</span> <span class="pre">/</span> <span class="pre">2.0</span></code> (again, within the <code class="docutils literal notranslate"><span class="pre">charm_glob_threshold</span></code> limit),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cell-&gt;lonmin[0]</span></code> has to be equal to <code class="docutils literal notranslate"><span class="pre">0.0</span></code> (still within the <code class="docutils literal notranslate"><span class="pre">charm_glob_threshold</span></code> limit),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cell-&gt;lonmax[cell-&gt;nlon</span> <span class="pre">-</span> <span class="pre">1]</span></code> has to be equal to <code class="docutils literal notranslate"><span class="pre">2.0</span> <span class="pre">*</span> <span class="pre">PI</span></code> (still within the <code class="docutils literal notranslate"><span class="pre">charm_glob_threshold</span></code> limit),</p></li>
<li><p>the maximum latitude of one cell has to be equal to the minimum latitude of the next cell that follows (the same holds also for the longitudes; both within the <code class="docutils literal notranslate"><span class="pre">charm_glob_threshold</span></code> limit).</p></li>
</ul>
</p>
<p>If possible, the function exploits the symmetry property of Legendre functions and their integrals with respect to the equator, thereby improving its performance (see <code class="docutils literal notranslate"><a class="reference internal" href="shs.html#charm__shs_8h_1add861cfba63c63d85c613ffe68af5c98"><span class="std std-ref"><span class="pre">charm_shs_cell()</span></span></a></code>).</p>
<p><strong>References</strong>:</p>
<p><ul class="simple">
<li><p>Colombo, O. L. (1981) Numerical methods for harmonic analysis on the sphere. Reports of the Department of Geodetic Science, Report No. 310, 140 pp</p></li>
<li><p>Heiskannen, W. A., Moritz, H. (1967) Physical Geodesy. W. H. Freeman and Company, San Francisco, 364 pp</p></li>
<li><p>Jekeli, C., Lee, J. K., Kwon, J. H. (2007) On the computation and approximation of ultra-high-degree spherical harmonic series. Journal of Geodesy 81:603-615</p></li>
<li><p>Fukushima, T. (2012) Numerical computation of spherical harmonics of arbitrary degree and order by extending exponent of floating point numbers. Journal of Geodesy 86:271-285.</p></li>
<li><p>Balmino, Vales, Bonvalot, Briais, 2012. Spherical harmonic modelling to ultra-high degree of Bouguer and isostatic anomalies. Journal of Geodesy 86:499-520, doi: 10.1007/s00190-011-0533-4</p></li>
<li><p>Fukushima, T. (2014) Numerical computation of spherical harmonics of arbitrary degree and order by extending exponent of floating point numbers: III integral. Computers &amp; Geosciences 63:17-21 </p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function modifies <code class="docutils literal notranslate"><span class="pre">shcs-&gt;c</span></code> and <code class="docutils literal notranslate"><span class="pre">shcs-&gt;s</span></code>, but it does not
touch the remaining members of <code class="docutils literal notranslate"><span class="pre">shcs</span></code>.  If <code class="docutils literal notranslate"><span class="pre">shcs-&gt;nmax</span> <span class="pre">&gt;</span> <span class="pre">nmax</span></code>, the
coefficients beyond <code class="docutils literal notranslate"><span class="pre">nmax</span></code> are set to zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> – <strong>[in]</strong> Structure defining grid cells (see <code class="docutils literal notranslate"><a class="reference internal" href="crd.html#structcharm__cell"><span class="std std-ref"><span class="pre">charm_cell</span></span></a></code>).</p></li>
<li><p><strong>f</strong> – <strong>[in]</strong> Input signal with block mean data given at the nodes of the <code class="docutils literal notranslate"><span class="pre">cell</span></code> structure. The pointer <code class="docutils literal notranslate"><span class="pre">f</span></code> must have an access to <code class="docutils literal notranslate"><span class="pre">cell-&gt;nlat</span> <span class="pre">*</span> <span class="pre">cell-&gt;nlon</span></code> array elements. The mean value of the signal at the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th cell in the latitudinal direction and the <code class="docutils literal notranslate"><span class="pre">j</span></code>-th cell in the longitudinal direction must be stored as <code class="docutils literal notranslate"><span class="pre">f[i</span> <span class="pre">*</span> <span class="pre">cell-&gt;nlon</span> <span class="pre">+</span> <span class="pre">j]</span></code> with <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">cell-&gt;nlat</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">...,</span> <span class="pre">pnt-&gt;nlon</span> <span class="pre">1</span></code>.</p></li>
<li><p><strong>nmax</strong> – <strong>[in]</strong> Maximum harmonic degree of the output spherical harmonic coefficients.</p></li>
<li><p><strong>method</strong> – <strong>[in]</strong> Method of spherical harmonic analysis of cell data. The only method currently supported is the approximate quadrature <code class="docutils literal notranslate"><span class="pre">CHARM_SHA_CELL_AQ</span></code> (described above).</p></li>
<li><p><strong>shcs</strong> – <strong>[out]</strong> Output spherical harmonic coefficients (see <code class="docutils literal notranslate"><a class="reference internal" href="shc.html#structcharm__shc"><span class="std std-ref"><span class="pre">charm_shc</span></span></a></code>).</p></li>
<li><p><strong>err</strong> – <strong>[out]</strong> Error reported by the function (if any). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="leg.html" class="btn btn-neutral float-right" title="charm_leg" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="shs.html" class="btn btn-neutral float-left" title="charm_shs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Blažej Bucha.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>
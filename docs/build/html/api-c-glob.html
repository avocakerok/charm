

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>charm_glob &mdash; CHarm 0.2.0-dev documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom_BB.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="charm" href="api-c-charm.html" />
    <link rel="prev" title="charm_err" href="api-c-err.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> CHarm
          

          
            
            <img src="_static/charm-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2.0-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="definitions.html">Some definitions to make things clear</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Cookbook</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">Interfaces</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="api-c.html">CHarm (C API)</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="api-c-shc.html">charm_shc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-crd.html">charm_crd</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-shs.html">charm_shs</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-sha.html">charm_sha</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-leg.html">charm_leg</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-integ.html">charm_integ</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-misc.html">charm_misc</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-xnum.html">charm_xnum</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-err.html">charm_err</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">charm_glob</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-c-charm.html">charm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api-py.html">PyHarm (Python API)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="platforms.html">Tested platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CHarm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api.html">Interfaces</a> &raquo;</li>
        
          <li><a href="api-c.html">CHarm (C API)</a> &raquo;</li>
        
      <li>charm_glob</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api-c-glob.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="charm-glob">
<span id="id1"></span><h1>charm_glob<a class="headerlink" href="#charm-glob" title="Permalink to this headline">¶</a></h1>
<p>Module defining global CHarm variables.</p>
<p>The global variables are declared in <code class="docutils literal notranslate"><span class="pre">charm_glob.h</span></code> and are initialized to safe values. Should you need to modify them for some reason, simply include <code class="docutils literal notranslate"><span class="pre">charm_glob.h</span></code> (or <code class="docutils literal notranslate"><span class="pre">charm.h</span></code>) in your code and set (without definition) the variables to whatever values you prefer. After that, whenever you call a CHarm routine that uses the global variables, the routine will use your own values instead of the default ones.</p>
<p><p><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This module is for experienced users only.  Most users should not
interact with it.</p>
</div>
</p>
</p>
<p><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This documentation is written for double precision version of CHarm. </p>
</div>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-thresholds-used-to-compare-floating-point-numbers">Thresholds used to compare floating point numbers</p>
<dl class="cpp var">
<dt id="_CPPv420charm_glob_threshold">
<span id="_CPPv320charm_glob_threshold"></span><span id="_CPPv220charm_glob_threshold"></span><span id="charm_glob_threshold__double"></span><span class="target" id="charm__glob_8h_1ab38bfd45ebf0f622c892ec1d0045c601"></span>double <code class="sig-name descname">charm_glob_threshold</code><a class="headerlink" href="#_CPPv420charm_glob_threshold" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Threshold to judge whether two floating point numbers are equal, <code class="docutils literal notranslate"><span class="pre">100.0</span> <span class="pre">*</span> <span class="pre">EPS</span></code>, where <code class="docutils literal notranslate"><span class="pre">EPS</span></code> is the machine epsilon of the floating point data type (<code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code> or <code class="docutils literal notranslate"><span class="pre">__float128</span></code>). Experienced users may (under some very specific circumstances) need the possibility to tighten or relax the threshold. </p>
</dd></dl>

<dl class="cpp var">
<dt id="_CPPv421charm_glob_threshold2">
<span id="_CPPv321charm_glob_threshold2"></span><span id="_CPPv221charm_glob_threshold2"></span><span id="charm_glob_threshold2__double"></span><span class="target" id="charm__glob_8h_1afb419caab47d66aff55c04d1339b4f7d"></span>double <code class="sig-name descname">charm_glob_threshold2</code><a class="headerlink" href="#_CPPv421charm_glob_threshold2" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>A more relaxed threshold to judge whether two floating point numbers are equal, <code class="docutils literal notranslate"><span class="pre">100000.0</span> <span class="pre">*</span> <span class="pre">EPS</span></code>. It is used to check longitudes of <em>custom</em> user-defined grids for a constant longitudinal step (required by the FFT-based algorithms). To this end, we use double differences. For high-resolution grids, the longitudinal step may be very small, so that two consecutive longitudes are very similar. Since double differences increase numerical errors, the threshold needs to be sufficiently large in such situations (yet narrow enough). The current value was found to be sufficient for quadrature grids associated with degrees as high as <code class="docutils literal notranslate"><span class="pre">70,000</span></code>. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-parameters-defining-the-polar-optimization">Parameters defining the polar optimization</p>
<p>CHarm can be told to skip the computation of all spherical harmonics during spherical harmonic synthesis/analysis for which</p>
<p><p><div class="math notranslate nohighlight">
\[m - n_{\max} \, \cos\varphi &gt; \max(a_1, a_2 \, n_{\max}){.}\]</div>
</p>
</p>
<p>If the parameters <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">a2</span></code> (see <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1a912f3a473bd2a2762a005616916dbe52"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a1</span></span></a></code> and <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a2</span></span></a></code>) are tuned reasonably, the polar optimization can improve the computation speed while <em>not</em> deteriorating the output accuracy. This is because the inequality filters out spherical harmonics that are of such small magnitudes in the polar areas that they do not contribute to the result (within the numerical precision). However, if the parameters are set unwisely, the accuracy can be compromised.</p>
<p>If the second polar optimization parameter <code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a2</span></span></a></code> is negative (which is the default), <em>no</em> polar optimization is applied, that is, all spherical harmonics are evaluated, regardless of their smallness in magnitude. If it is non-negative, the polar optimization is applied.</p>
<p>In <strong>double</strong> precision, the following values of the tuning parameters improve the computation speed and, in most cases, can safely be used without deteriorating the accuracy (Reinecke and Seljebotn, 2013):</p>
<p><ul class="simple">
<li><p><code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1a912f3a473bd2a2762a005616916dbe52"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a1</span></span></a> <span class="pre">=</span> <span class="pre">100</span></code> and</p></li>
<li><p><code class="docutils literal notranslate"><a class="reference internal" href="#charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"><span class="std std-ref"><span class="pre">charm_glob_polar_optimization_a2</span></span></a> <span class="pre">=</span> <span class="pre">0.01</span></code>.</p></li>
</ul>
</p>
<p>In single and quadruple precision, different values of the tuning parameters are needed. Currently, we do not provide any recommendations, though.</p>
<p><strong>References</strong>:</p>
<p><ul class="simple">
<li><p>Reinecke, M., Seljebotn, D. S. (2013) Libsharp  spherical harmonic transforms revisited. Astronomy and Astrophysics 554, A112, doi: 10.1051/0004-6361/201321494. </p></li>
</ul>
</p>
<dl class="cpp var">
<dt id="_CPPv432charm_glob_polar_optimization_a1">
<span id="_CPPv332charm_glob_polar_optimization_a1"></span><span id="_CPPv232charm_glob_polar_optimization_a1"></span><span id="charm_glob_polar_optimization_a1__unsigned-l"></span><span class="target" id="charm__glob_8h_1a912f3a473bd2a2762a005616916dbe52"></span>unsigned long <code class="sig-name descname">charm_glob_polar_optimization_a1</code><a class="headerlink" href="#_CPPv432charm_glob_polar_optimization_a1" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Polar optimization parameter (default is <code class="docutils literal notranslate"><span class="pre">100</span></code>) </p>
</dd></dl>

<dl class="cpp var">
<dt id="_CPPv432charm_glob_polar_optimization_a2">
<span id="_CPPv332charm_glob_polar_optimization_a2"></span><span id="_CPPv232charm_glob_polar_optimization_a2"></span><span id="charm_glob_polar_optimization_a2__double"></span><span class="target" id="charm__glob_8h_1ab5fc3b2f3555814f59ea7d7fd8004de0"></span>double <code class="sig-name descname">charm_glob_polar_optimization_a2</code><a class="headerlink" href="#_CPPv432charm_glob_polar_optimization_a2" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Polar optimization parameter (default is <code class="docutils literal notranslate"><span class="pre">-1.0</span></code>, that is, no polar optimization) </p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api-c-charm.html" class="btn btn-neutral float-right" title="charm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="api-c-err.html" class="btn btn-neutral float-left" title="charm_err" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Blažej Bucha.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>